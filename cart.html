<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">

        <link href="css/jquery-ui.min.css" rel="stylesheet" type="text/css">
        <link href="css/bootstrap.min.css" rel="stylesheet" type="text/css">
        <link href="css/main.css" rel="stylesheet" type="text/css">
        <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

        <script src="js/jquery-1.10.2.min.js"></script>
        <script src="js/jquery-ui.min.js"></script>
        <script src="js/bootstrap.min.js"></script>
        <script src="js/vue.js"></script>
        <script src="js/vue-resource.min.js"></script>

    </head>
    <body>
        <div class="cart">
            <div class="navbar">
                <div class="justify-content-end align-items-center">
                    <button type="button"><span class="material-icons">arrow_back</span></button>
                    <span class="ttile">購物車</span>
                </div>
            </div>
            <div class="container-fluid">
                <div class="row">
                    <div class="col-12" v-for="detail in cart" @click="goDetail(detail.no)">
                    <!-- <div class="col-12"> -->
                        <div class="cart_edit">
                            <span class="material-icons">check_box_outline_blank</span>
                            <span class="material-icons">storefront</span>
                            <span class="ttile">TOTAL</span>
                            <button type="button" class="edit">編輯</button>
                        </div>
                        <div class="cart_detail">
                            <span class="material-icons">check_box_outline_blank</span>
                            <div class="cart_detail_img">
                                <img class="img" :src="detail.pimg">
                            </div>
                            <div class="cart_detail_text">
                                <div class="pname">{{detail.pname}}</div>
                                <div class="price">${{detail.pprice}}</div>
                                <div class="num">{{detail.pnum}}</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="bottom">
                    <button class="confirm">結帳</button>
                    <div class="total">總金額<span>${{cart.length>0?cart[0].total:0}}</span></div>
                </div>
            </div>
        </div>
    </body>
</html>

<script>
var cart = new Vue({
        el: '.cart',
        data: {
            cart: [],
            // detail: {
            //     "mobile": "0966888888",
            //     "pimg": "http://125.228.2.127/interview/img/total3.jpg",
            //     "pno": "P00003",
            //     "pname": "Total1機油",
            //     "pprice": "200",
            //     "pnum": "6",
            //     "total": "1200",
            //     "cTime": "2021-08-04 12:02:32"
            // }
        },
        watch: {},
        created: function(){
            this.getCart();
        },
        computed: {},
        methods: {
            // 取得列表
            getCart: function(){
                var postData = {
                    "action": "GetCartList",
                    "table": "testproductdata",
                    "mobile" : "0916020378"
                };
                this.$http.post('http://125.228.2.127/interview/RtyW0804/list.php', postData, {emulateJSON:true})
                .then((res) => {
                    if(typeof res.body == 'object'){
                        this.cart = res.body;
                    }
                });
            }
        },
    })
</script>
